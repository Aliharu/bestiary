<mat-card>
  <mat-toolbar color="warn">
    <h1>
      <mat-form-field>
        <input matInput [value]="beast.name" (change)="captureInput($event, 'name')" placeholder="Name">
      </mat-form-field>
      <mat-form-field>
        <input matInput [value]="beast.plural" (change)="captureInput($event, 'plural')" placeholder="Pluralized Name">
      </mat-form-field>
    </h1>
    <div>
      <h1>HR:
        <mat-form-field>
          <input class="hr-input" matInput [value]="beast.hr" (change)="captureInput($event, 'hr')">
        </mat-form-field>
      </h1>
    </div>
  </mat-toolbar>

  <div class="content-shell">

    <div class="left">
      <mat-form-field>
        <mat-label>Patreon Level</mat-label>
        <mat-select [value]="beast.patreon" (selectionChange)="captureSelect($event, 'patreon')">
          <mat-option value="0">
            Basic
          </mat-option>
          <mat-option value="3">
            Deluxe
          </mat-option>
          <mat-option value="20">
            Early Access
          </mat-option>
        </mat-select>
        <p>{{beast.patreon}}</p>
      </mat-form-field>

      <div>
        <img *ngIf="beast.id" [src]="imageBase + beast.id" [alt]="beast.name"
          onerror="this.onerror=null;this.src='/assets/404.png';">
      </div>

      <div class="margin-spacing" *ngIf="beast.id">
        <input (change)="onImagePicked($event)" placeholder="Upload Image" type="file" />
        <button mat-button-raised color="accent" (click)="onImageUpload()">Upload Image</button>
      </div>

      <div class="thumbnailShell">
        <mat-form-field>
          <mat-label>Thumbnail Position</mat-label>
          <mat-select [value]="beast.thumbnail" (selectionChange)="captureSelect($event, 'thumbnail')">
            <mat-option value="top left">
              top left
            </mat-option>
            <mat-option value="top center">
              top center
            </mat-option>
            <mat-option value="top right">
              top right
            </mat-option>
            <mat-option value="center left">
              center left
            </mat-option>
            <mat-option value="center center">
              center center
            </mat-option>
            <mat-option value="center right">
              center right
            </mat-option>
            <mat-option value="bottom left">
              bottom left
            </mat-option>
            <mat-option value="bottom center">
              bottom center
            </mat-option>
            <mat-option value="bottom right">
              bottom right
            </mat-option>
          </mat-select>
        </mat-form-field>
        <div class="flex-row-opposite">
          <h3>Current Thumbnail Position</h3>
          <p>{{beast.thumbnail}}</p>
        </div>

        <img class="preview" [ngStyle]="{'object-position': beast.thumbnail ? beast.thumbnail : 'top'}" *ngIf="beast.id"
          [src]="imageBase + beast.id" [alt]="beast.name">
      </div>

      <div class="margin-spacing" *ngIf="!beast.id">
        <h3>You need to save this monster before uploading an image</h3>
      </div>

      <div class="conflict-shell">
        <div *ngFor="let trait of beast.conflict.traits; let i = index">
          <div *ngIf="!trait.deleted">
            <h3>
              <mat-form-field>
                <input placeholder="Trait" matInput [value]="trait.trait"
                  (change)="captureInput($event, 'conflict', i, 'traits', 'trait')">
              </mat-form-field>
            </h3>
            <mat-form-field>
              <input placeholder="Dice Value" matInput [value]="trait.value"
                (change)="captureInput($event, 'conflict', i, 'traits', 'value')">
            </mat-form-field>
            <button mat-raised-button (click)="removeNewSecondaryItem('conflict', i, 'traits')" color="warn">REMOVE
              TRAIT</button>
          </div>
        </div>
      </div>
      <button mat-raised-button (click)="addNewSecondaryItem('conflict', 'traits')" color="accent">ADD TRAIT</button>
      <br />
      <mat-form-field>
        <input matInput placeholder="Max Traits Appearing" [value]="beast.traitlimit"
          (change)="captureInput($event, 'traitlimit')">
      </mat-form-field>

      <div class="divider"></div>

      <div class="conflict-shell">
        <div *ngFor="let devotion of beast.conflict.devotions; let i = index">
          <div *ngIf="!devotion.deleted">
            <h3>
              <mat-form-field>
                <input placeholder="devotion" matInput [value]="devotion.trait"
                  (change)="captureInput($event, 'conflict', i, 'devotions', 'trait')">
              </mat-form-field>
            </h3>
            <mat-form-field>
              <input placeholder="Dice Value" matInput [value]="devotion.value"
                (change)="captureInput($event, 'conflict', i, 'devotions', 'value')">
            </mat-form-field>
            <button mat-raised-button (click)="removeNewSecondaryItem('conflict', i, 'devotions')" color="warn">REMOVE
              DEVOTION</button>
          </div>
        </div>
      </div>
      <button mat-raised-button (click)="addNewSecondaryItem('conflict', 'devotions')" color="accent">ADD
        DEVOTIONS</button>
      <br />
      <mat-form-field>
        <input matInput placeholder="Max Devotions Appearing" [value]="beast.devotionlimit"
          (change)="captureInput($event, 'devotionlimit')">
      </mat-form-field>

      <div class="divider"></div>

      <div class="conflict-shell">
        <div *ngFor="let flaw of beast.conflict.flaws; let i = index">
          <div *ngIf="!flaw.deleted">
            <h3>
              <mat-form-field>
                <input placeholder="flaw" matInput [value]="flaw.trait"
                  (change)="captureInput($event, 'conflict', i, 'flaws', 'trait')">
              </mat-form-field>
            </h3>
            <mat-form-field>
              <input placeholder="Dice Value" matInput [value]="flaw.value"
                (change)="captureInput($event, 'conflict', i, 'flaws', 'value')">
            </mat-form-field>
            <button mat-raised-button (click)="removeNewSecondaryItem('conflict', i, 'flaws')" color="warn">REMOVE
              FLAW</button>
          </div>
        </div>
      </div>
      <button mat-raised-button (click)="addNewSecondaryItem('conflict', 'flaws')" color="accent">ADD FLAW</button>
      <br />
      <mat-form-field>
        <input matInput placeholder="Max Flaws Appearing" [value]="beast.flawlimit"
          (change)="captureInput($event, 'flawlimit')">
      </mat-form-field>

      <div class="divider"></div>
      <div class="conflict-shell">
        <div *ngFor="let passion of beast.conflict.passions; let i = index">
          <div *ngIf="!passion.deleted">
            <h3>
              <mat-form-field>
                <input placeholder="passion" matInput [value]="passion.trait"
                  (change)="captureInput($event, 'conflict', i, 'passions', 'trait')">
              </mat-form-field>
            </h3>
            <mat-form-field>
              <input placeholder="Dice Value" matInput [value]="passion.value"
                (change)="captureInput($event, 'conflict', i, 'passions', 'value')">
            </mat-form-field>
            <button mat-raised-button (click)="removeNewSecondaryItem('conflict', i, 'passions')" color="warn">REMOVE
              PASSION</button>
          </div>
        </div>
      </div>
      <button mat-raised-button (click)="addNewSecondaryItem('conflict', 'passions')" color="accent">ADD
        PASSION</button>
      <br />
      <mat-form-field>
        <input matInput placeholder="Max Passions Appearing" [value]="beast.passionlimit"
          (change)="captureInput($event, 'passionlimit')">
      </mat-form-field>

      <div class="divider"></div>

      <div class="conflict-inner-shell">
        <div *ngFor="let skill of beast.skills; let i = index">
          <div *ngIf="!skill.deleted">
            <h3>
              <mat-form-field>
                <input placeholder="Skill Name" matInput [value]="skill.skill"
                  (change)="captureInput($event, 'skills', i, 'skill')">
              </mat-form-field>
            </h3>
            <mat-form-field>
              <input placeholder="Skill Rank" matInput [value]="skill.rank"
                (change)="captureInput($event, 'skills', i, 'rank')">
            </mat-form-field>
            <button mat-raised-button (click)="removeNewSecondaryItem('skills', i)" color="warn">REMOVE
              SKILL</button>
          </div>
        </div>
      </div>
      <button mat-raised-button (click)="addNewSecondaryItem('skills')" color="accent">ADD SKILL</button>

      <div class="divider"></div>

      <div class="combat-shell">
        <div *ngFor="let square of beast.combat; let i = index">
          <div *ngIf="!square.deleted">
            <h3>
              <mat-form-field>
                <input placeholder="Weapon Name" matInput [value]="square.weapon"
                  (change)="captureInput($event, 'combat', i, 'weapon')">
              </mat-form-field>
            </h3>
            <mat-form-field>
              <input placeholder="Recovery" matInput [value]="square.spd"
                (change)="captureInput($event, 'combat', i, 'spd')">
            </mat-form-field>
            <mat-form-field>
              <input placeholder="Attack" matInput [value]="square.atk"
                (change)="captureInput($event, 'combat', i, 'atk')">
            </mat-form-field>
            <mat-form-field>
              <input placeholder="Initiative" matInput [value]="square.init"
                (change)="captureInput($event, 'combat', i, 'init')">
            </mat-form-field>
            <mat-form-field>
              <input placeholder="Defense" matInput [value]="square.def"
                (change)="captureInput($event, 'combat', i, 'def')">
            </mat-form-field>
            <mat-form-field>
              <input placeholder="Encumbrance" matInput [value]="square.encumb"
                (change)="captureInput($event, 'combat', i, 'encumb')">
            </mat-form-field>
            <!-- This needs to be changed so you can modifiy shields as well -->
            <mat-form-field>
              <input placeholder="DR" matInput [value]="square.dr" (change)="captureInput($event, 'combat', i, 'dr')">
            </mat-form-field>
            <mat-form-field>
              <input placeholder="Shield DR" matInput [value]="square.shield_dr"
                (change)="captureInput($event, 'combat', i, 'shield_dr')">
            </mat-form-field>
            <mat-form-field>
              <input placeholder="Measure" matInput [value]="square.measure"
                (change)="captureInput($event, 'combat', i, 'measure')">
            </mat-form-field>
            <mat-form-field>
              <input placeholder="Damage" matInput [value]="square.damage"
                (change)="captureInput($event, 'combat', i, 'damage')">
            </mat-form-field>
            <mat-form-field>
              <input placeholder="Parry" matInput [value]="square.parry"
                (change)="captureInput($event, 'combat', i, 'parry')">
            </mat-form-field>
            <mat-form-field>
              <mat-label>Weapon Type</mat-label>
              <mat-select [value]="square.weapontype"
                (selectionChange)="captureSelect($event, 'combat', i, 'weapontype')">
                <mat-option value="m">
                  m
                </mat-option>
                <mat-option value="r">
                  r
                </mat-option>
              </mat-select>
            </mat-form-field>

            <div *ngIf="square.weapontype == 'r'" class="ranged-shell">
              <h3>Range</h3>
              <div class="ranged-title">
                <h4>Penalty</h4>
                <h4>Range (ft)</h4>
              </div>
              <div>
                <h4>0</h4>
                <h4>5 - {{(+square.ranges.thirtytwo / 6 | number:'1.0-0')}}</h4>
              </div>
              <div class="ranged-odd">
                <h4>-2</h4>
                <h4>{{(+square.ranges.thirtytwo / 6) + 1 | number:'1.0-0'}} -
                  {{(+square.ranges.thirtytwo / 6) * 2 | number:'1.0-0'}}</h4>
              </div>
              <div>
                <h4>-4</h4>
                <h4>{{(+square.ranges.thirtytwo / 6) + 1 | number:'1.0-0'}} -
                  {{(+square.ranges.thirtytwo / 6) * 3 | number:'1.0-0'}}</h4>
              </div>
              <div class="ranged-odd">
                <h4>-8</h4>
                <h4>{{((+square.ranges.thirtytwo / 6) * 2) + 1 | number:'1.0-0'}} -
                  {{(+square.ranges.thirtytwo / 6) * 4 | number:'1.0-0'}}</h4>
              </div>
              <div>
                <h4>-16</h4>
                <h4>{{((+square.ranges.thirtytwo / 6) * 3) + 1 | number:'1.0-0'}} -
                  {{(+square.ranges.thirtytwo / 6) * 5 | number:'1.0-0'}}</h4>
              </div>
              <div class="ranged-odd">
                <h4>-32</h4>
                <h4>{{((+square.ranges.thirtytwo / 6) * 2) + 1 | number:'1.0-0'}} -
                  {{square.ranges.thirtytwo | number:'1.0-0'}}</h4>
              </div>
              <mat-form-field>
                <input placeholder="Max Range" matInput [value]="square.ranges.thirtytwo"
                  (change)="captureInput($event, 'combat', i, 'ranges', 'thirtytwo')">
              </mat-form-field>
            </div>

            <button mat-raised-button (click)="removeNewSecondaryItem('combat', i)" color="warn">REMOVE
              WEAPON</button>
          </div>
        </div>
      </div>
      <button mat-raised-button (click)="addNewSecondaryItem('combat')" color="accent">ADD WEAPON</button>

      <div class="vitals-shell">
        <mat-form-field>
          <input matInput placeholder="Vitality" [value]="beast.vitality" (change)="captureInput($event, 'vitality')">
        </mat-form-field>
        <p>(Ave: {{averageVitality}})</p>

        <div *ngFor="let location of beast.locationalvitality; let i = index">
          <br />
          <div *ngIf="!location.deleted">
            <mat-form-field>
              <input placeholder="Location" matInput [value]="location.location"
                (change)="captureInput($event, 'locationalvitality', i, 'location')">
            </mat-form-field>
            <mat-form-field>
              <input placeholder="Vitality" matInput [value]="location.vitality"
                (change)="captureInput($event, 'locationalvitality', i, 'vitality')">
            </mat-form-field>
            <p>(Ave: {{calculatorService.calculateAverageOfDice(location.vitality)}})</p>
            <button mat-raised-button (click)="removeNewSecondaryItem('locationalvitality', i)" color="warn">REMOVE
              LOCATION</button>
          </div>
        </div>

        <button mat-raised-button (click)="addNewSecondaryItem('locationalvitality')" color="accent">ADD LOCATION
          VITALITY</button>
        <br />
        <br />
        <mat-form-field>
          <input matInput placeholder="Stress Threshold" [value]="beast.stress"
            (change)="captureInput($event, 'stress')">
        </mat-form-field>

        <mat-form-field>
          <mat-label>Panic</mat-label>
          <mat-select [value]="beast.panic" (selectionChange)="captureSelect($event, 'panic')">
            <mat-option value="1">
              Always
            </mat-option>
            <mat-option value="2">
              Hurt
            </mat-option>
            <mat-option value="3">
              Bloodied
            </mat-option>
            <mat-option value="4">
              Wounded
            </mat-option>
            <mat-option value="5">
              Bleeding Out
            </mat-option>
            <mat-option value="7">
              Never
            </mat-option>
          </mat-select>
        </mat-form-field>
        <div class="flex-row-opposite">
          <h3>Current Panic</h3>
          <p>{{beast.panic | moraleConverter}}</p>
        </div>
      </div>

      <div class="vitals-shell">
        <h3 class="blue">Movement</h3>
        <div *ngFor="let movementType of beast.movement; let i = index">
          <div *ngIf="!movementType.deleted">
            <div class="divider white"></div>
            <h3>
              <mat-form-field>
                <input placeholder="Movement Type" matInput [value]="movementType.type"
                  (change)="captureInput($event, 'movement', i, 'type')">
              </mat-form-field>
            </h3>
            <div class="divider white"></div>
            <mat-form-field>
              <input placeholder="Stroll/Crawl" matInput [value]="movementType.stroll"
                (change)="captureInput($event, 'movement', i, 'stroll')">
            </mat-form-field>
            <mat-form-field>
              <input placeholder="Walk" matInput [value]="movementType.walk"
                (change)="captureInput($event, 'movement', i, 'walk')">
            </mat-form-field>
            <mat-form-field>
              <input placeholder="Jog" matInput [value]="movementType.jog"
                (change)="captureInput($event, 'movement', i, 'jog')">
            </mat-form-field>
            <mat-form-field>
              <input placeholder="Run" matInput [value]="movementType.run"
                (change)="captureInput($event, 'movement', i, 'run')">
            </mat-form-field>
            <mat-form-field>
              <input placeholder="Sprint" matInput [value]="movementType.sprint"
                (change)="captureInput($event, 'movement', i, 'sprint')">
            </mat-form-field>
            <button mat-raised-button (click)="removeNewSecondaryItem('movement', i)" color="warn">REMOVE
              MOVEMENT</button>
          </div>
        </div>
        <button mat-raised-button (click)="addNewSecondaryItem('movement')" color="accent">ADD MOVEMENT</button>
      </div>

      <h2>Add. Attack Info</h2>
      <div class="divider"></div>
      <div>
        <quill-editor [(ngModel)]="beast.sp_atk" (onContentChanged)="captureHTML($event, 'sp_atk')"></quill-editor>
      </div>

      <h2>Add. Defense Info</h2>
      <div class="divider"></div>
      <div>
        <quill-editor [(ngModel)]="beast.sp_def" (onContentChanged)="captureHTML($event, 'sp_def')"></quill-editor>
      </div>

      <h2>Tactics</h2>
      <div class="divider"></div>
      <div>
        <quill-editor [(ngModel)]="beast.tactics" (onContentChanged)="captureHTML($event, 'tactics')"></quill-editor>
      </div>
    </div>

    <div class="right">
      <h2>Introduction</h2>
      <div class="divider"></div>
      <div>
        <quill-editor [(ngModel)]="beast.intro" (onContentChanged)="captureHTML($event, 'intro')"></quill-editor>
      </div>

      <h2>Appearance</h2>
      <div class="divider"></div>
      <div>
        <quill-editor [(ngModel)]="beast.ecology" (onContentChanged)="captureHTML($event, 'ecology')"></quill-editor>
      </div>

      <h2>Habitat/Society</h2>
      <div class="divider"></div>
      <div>
        <quill-editor [(ngModel)]="beast.habitat" (onContentChanged)="captureHTML($event, 'habitat')"></quill-editor>
      </div>

      <h2>Random Encounter</h2>
      <div class="divider"></div>
      <div *ngIf="encounter">
        <div>
          <h3>Temperament</h3>
          <div>
            <div *ngFor="let temperament of encounter.temperament.temperament; let i = index">
              <div class="temperamentList" *ngIf="!temperament.deleted">
                <p>{{temperament.temperament}}</p>
                <p>{{temperament.weight}}</p>
                <!-- <mat-form-field>
                  <input placeholder="Weight" matInput [value]="temperament.weight"
                    (change)="captureEncounterInput($event, 'temperament', i)">
                </mat-form-field> -->
                <i (click)="removeEncounterItem(i, 'temperament', 'temperament')" class="fas fa-times-circle"></i>
              </div>
            </div>
            <mat-form-field>
              <mat-label>Select Temperament</mat-label>
              <mat-select (selectionChange)="captureEncounter($event, 'temperament')">
                <mat-option *ngFor="let temperament of encounter.temperament.allTemp" [value]="temperament">
                  {{temperament.temperament}}
                </mat-option>
              </mat-select>
            </mat-form-field>
            <mat-form-field>
              <input placeholder="Weight" matInput (change)="captureEncounterInput($event, 'temperament', 'weight')">
            </mat-form-field>
          </div>
          <h3>OR</h3>
          <div>
            <mat-form-field>
              <input placeholder="Add Temperament" matInput [value]="temperament.temperament"
                (change)="captureEncounterInput($event, 'temperament', 'temperament')">
            </mat-form-field>
            <mat-form-field>
              <input placeholder="Add Temperament Tooltip" matInput [value]="temperament.tooltip"
                (change)="captureEncounterInput($event, 'temperament', 'tooltip')">
            </mat-form-field>
            <mat-form-field>
              <input placeholder="Weight" matInput [value]="temperament.weight"
                (change)="captureEncounterInputInt($event, 'temperament', 'weight')">
            </mat-form-field>
          </div>
          <button mat-raised-button (click)="addEncounterItem('temperament', 'temperament')" color="accent"
            [disabled]="!temperament.temperament || !temperament.tooltip || !temperament.weight">Add
            Temperament</button>
        </div>

        <div>
          <h3>Rank</h3>
          <div>
            <div *ngFor="let rank of encounter.rank.rank; let i = index">
              <div class="temperamentList" *ngIf="!rank.deleted">
                <p>{{rank.rank}}</p>
                <p>{{rank.weight}}</p>
                <p>{{rank.othertypechance}}%</p>
                <p>-{{rank.decayrate}}%</p>
                <p>{{rank.lair}} miles</p>
                <p>#{{rank.number}}</p>
                <i (click)="removeEncounterItem(i, 'rank', 'rank')" class="fas fa-times-circle"></i>
              </div>
            </div>
            <mat-form-field>
              <mat-label>Select Rank</mat-label>
              <mat-select (selectionChange)="captureEncounter($event, 'rank')">
                <mat-option *ngFor="let rank of encounter.rank.allRank" [value]="rank">
                  {{rank.rank}}
                </mat-option>
              </mat-select>
            </mat-form-field>
            <mat-form-field>
              <input placeholder="Weight" matInput (change)="captureEncounterInput($event, 'rank', 'weight')">
            </mat-form-field>
            <mat-form-field>
              <input placeholder="Other Type Chance" matInput
                (change)="captureEncounterInput($event, 'rank', 'othertypechance')">
            </mat-form-field>
            <mat-form-field>
              <input placeholder="Decay Rate" matInput (change)="captureEncounterInput($event, 'rank', 'decayrate')">
            </mat-form-field>
            <mat-form-field>
              <input placeholder="Lair Distance as dice" matInput
                (change)="captureEncounterInput($event, 'rank', 'lair')">
            </mat-form-field>
            <mat-form-field>
              <input placeholder="Number as dice" matInput (change)="captureEncounterInput($event, 'rank', 'number')">
            </mat-form-field>
          </div>
          <h3>OR</h3>
          <div>
            <mat-form-field>
              <input placeholder="Add Rank" matInput [value]="rank.rank"
                (change)="captureEncounterInput($event, 'rank', 'rank')">
            </mat-form-field>
            <mat-form-field>
              <input placeholder="Weight" matInput (change)="captureEncounterInputInt($event, 'rank', 'weight')">
            </mat-form-field>
            <mat-form-field>
              <input placeholder="Other Type Chance" matInput
                (change)="captureEncounterInputInt($event, 'rank', 'othertypechance')">
            </mat-form-field>
            <mat-form-field>
              <input placeholder="Decay Rate" matInput (change)="captureEncounterInputInt($event, 'rank', 'decayrate')">
            </mat-form-field>
            <mat-form-field>
              <input placeholder="Lair Distance as dice" matInput [value]="rank.lair"
                (change)="captureEncounterInput($event, 'rank', 'lair')">
            </mat-form-field>
            <mat-form-field>
              <input placeholder="Number as dice" matInput (change)="captureEncounterInput($event, 'rank', 'number')">
            </mat-form-field>
          </div>
          <button mat-raised-button (click)="addEncounterItem('rank', 'rank')" color="accent"
            [disabled]="!rank.rank || !rank.weight || !rank.othertypechance || !rank.decayrate || !rank.lair || !rank.number || (rank.othertypechance > 0 && rank.decayrate <= 0)">Add
            Rank</button>
        </div>

        <div>
          <h3>Verb</h3>
          <div>
            <div *ngFor="let verb of encounter.verb.verb; let i = index">
              <div class="temperamentList" *ngIf="!verb.deleted">
                <p>{{verb.verb}}</p>
                <i (click)="removeEncounterItem(i, 'verb', 'verb')" class="fas fa-times-circle"></i>
              </div>
            </div>
            <mat-form-field>
              <mat-label>Select Verb</mat-label>
              <mat-select (selectionChange)="captureEncounter($event, 'verb')">
                <mat-option *ngFor="let verb of encounter.verb.allVerb" [value]="verb">
                  {{verb.verb}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <h3>OR</h3>
          <div>
            <mat-form-field>
              <input placeholder="Add Verb" matInput [value]="verb.verb"
                (change)="captureEncounterInput($event, 'verb', 'verb')">
            </mat-form-field>
          </div>
          <button mat-raised-button (click)="addEncounterItem('verb', 'verb')" color="accent"
            [disabled]="!verb.verb">Add Verb</button>
        </div>

        <div>
          <h3>Noun</h3>
          <div>
            <div *ngFor="let noun of encounter.noun.noun; let i = index">
              <div class="temperamentList" *ngIf="!noun.deleted">
                <p>{{noun.noun}}</p>
                <i (click)="removeEncounterItem(i, 'noun', 'noun')" class="fas fa-times-circle"></i>
              </div>
            </div>
            <mat-form-field>
              <mat-label>Select Noun</mat-label>
              <mat-select (selectionChange)="captureEncounter($event, 'noun')">
                <mat-option *ngFor="let noun of encounter.noun.allNoun" [value]="noun">
                  {{noun.noun}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <h3>OR</h3>
          <div>
            <mat-form-field>
              <input placeholder="Add Noun" matInput [value]="noun.noun"
                (change)="captureEncounterInput($event, 'noun', 'noun')">
            </mat-form-field>
          </div>
          <button mat-raised-button (click)="addEncounterItem('noun', 'noun')" color="accent"
            [disabled]="!noun.noun">Add Noun</button>
        </div>
      </div>


      <h2>Type</h2>
      <div class="divider"></div>
      <div class="chip-shell box-padding">
        <mat-chip-list>
          <div *ngFor="let type of beast.types; let i = index">
            <mat-chip *ngIf="!type.deleted" (click)="removeNewSecondaryItem('types', i)" color="warn" selected>
              {{type.typeid | typeConverter}}</mat-chip>
          </div>
        </mat-chip-list>
        <mat-form-field>
          <mat-label>Select New Type</mat-label>
          <mat-select (selectionChange)="captureChip($event, 'types')">
            <mat-option value="1">
              Demon
            </mat-option>
            <mat-option value="2">
              Undead, Corporeal
            </mat-option>
            <mat-option value="3">
              Undead, Incorporeal
            </mat-option>
            <mat-option value="4">
              Elemental
            </mat-option>
            <mat-option value="5">
              Natural Creature
            </mat-option>
            <mat-option value="6">
              Weird Creature
            </mat-option>
            <mat-option value="7">
              Humanoid
            </mat-option>
            <mat-option value="8">
              Intelligent Evil
            </mat-option>
            <mat-option value="9">
              Goblin
            </mat-option>
            <mat-option value="10">
              Swarm
            </mat-option>
            <mat-option value="11">
              Flora
            </mat-option>
            <mat-option value="12">
              Aos Sidhe
            </mat-option>
            <mat-option value="13">
              Spirit
            </mat-option>
            <mat-option value="14">
              Eldritch
            </mat-option>
          </mat-select>
        </mat-form-field>
        <button mat-raised-button color="accent" (click)="addChip('types')">Add Type</button>
      </div>
      <!-- list of types that link to search with that type as a parameter -->

      <h2>Misc Information</h2>
      <div class="divider"></div>
      <div class="box-padding">

        <mat-form-field>
          <mat-label>Size</mat-label>
          <mat-select [value]="beast.size" (selectionChange)="captureSelect($event, 'size')">
            <mat-option value="Fine">
              Fine
            </mat-option>
            <mat-option value="Diminutive">
              Diminutive
            </mat-option>
            <mat-option value="Tiny">
              Tiny
            </mat-option>
            <mat-option value="Small">
              Small
            </mat-option>
            <mat-option value="Medium">
              Medium
            </mat-option>
            <mat-option value="Large">
              Large
            </mat-option>
            <mat-option value="Huge">
              Huge
            </mat-option>
            <mat-option value="Giant">
              Giant
            </mat-option>
            <mat-option value="Enormous">
              Enormous
            </mat-option>
            <mat-option value="Colossal">
              Colossal
            </mat-option>
          </mat-select>
        </mat-form-field>


        <mat-form-field>
          <input matInput placeholder="Intelligence" [value]="beast.int" (change)="captureInput($event, 'int')">
        </mat-form-field>

        <h3>Environment</h3>
        <div class="chip-shell">
          <mat-chip-list>
            <div *ngFor="let environ of beast.environ; let i = index">
              <mat-chip *ngIf="!environ.deleted" (click)="removeNewSecondaryItem('environ', i)" color="warn" selected>
                {{environ.environid | environConverter}}
              </mat-chip>
            </div>
          </mat-chip-list>
          <mat-form-field>
            <mat-label>Select New Environ</mat-label>
            <mat-select (selectionChange)="captureChip($event, 'environ')">
              <mat-option value="1">
                Dungeon/Ruins
              </mat-option>
              <mat-option value="2">
                Wilderness
              </mat-option>
              <mat-option value="3">
                Forest
              </mat-option>
              <mat-option value="4">
                Castle
              </mat-option>
              <mat-option value="5">
                Cave/Underground
              </mat-option>
              <mat-option value="6">
                Mountain
              </mat-option>
              <mat-option value="7">
                Plains
              </mat-option>
              <mat-option value="8">
                Swamp
              </mat-option>
              <mat-option value="9">
                Urban
              </mat-option>
              <mat-option value="10">
                Ship
              </mat-option>
              <mat-option value="11">
                Coastal
              </mat-option>
              <mat-option value="12">
                Aquatic
              </mat-option>
              <mat-option value="13">
                Other
              </mat-option>
              <mat-option value="14">
                Desert
              </mat-option>
              <mat-option value="15">
                Island
              </mat-option>
              <mat-option value="16">
                Jungle
              </mat-option>
              <mat-option value="17">
                Sewer
              </mat-option>
              <mat-option value="18">
                House
              </mat-option>
            </mat-select>
          </mat-form-field>
          <button mat-raised-button color="accent" (click)="addChip('environ')">Add Environment</button>
        </div>

        <mat-form-field>
          <mat-label>Rarity</mat-label>
          <mat-select (selectionChange)="captureSelect($event, 'rarity')">
            <mat-option value="10">
              Common
            </mat-option>
            <mat-option value="5">
              Uncommon
            </mat-option>
            <mat-option value="3">
              Rare
            </mat-option>
            <mat-option value="1">
              Legendary
            </mat-option>
          </mat-select>
        </mat-form-field>
        <div class="flex-row-opposite">
          <h3>Current Rarity</h3>
          <p>{{beast.rarity | rarityConverter}}</p>
        </div>

        <mat-form-field>
          <input placeholder="Senses" matInput [value]="beast.senses" (change)="captureInput($event, 'senses')">
        </mat-form-field>

        <mat-form-field>
          <input matInput placeholder="Diet" [value]="beast.diet" (change)="captureInput($event, 'diet')">
        </mat-form-field>

        <mat-form-field>
          <mat-label>Subsystem Focus</mat-label>
          <mat-select (selectionChange)="captureSelect($event, 'subsystem')">
            <mat-option value="1">
              Combat
            </mat-option>
            <mat-option value="2">
              Social
            </mat-option>
            <mat-option value="3">
              Skill
            </mat-option>
            <mat-option>
              none
            </mat-option>
          </mat-select>
        </mat-form-field>
        <div class="flex-row-opposite">
          <h3>Current Subsystem</h3>
          <p>{{beast.subsystem | subsystemConverter}}</p>
        </div>
      </div>

      <h2>Loot</h2>
      <div class="divider"></div>
      <div *ngFor="let lootitem of beast.loot; let i = index">
        <div *ngIf="!lootitem.deleted">
          <h3>
            <mat-form-field>
              <input placeholder="Loot" matInput [value]="lootitem.loot"
                (change)="captureInput($event, 'loot', i, 'loot')">
            </mat-form-field>
          </h3>
          <mat-form-field>
            <input placeholder="Value" matInput [value]="lootitem.price"
              (change)="captureInput($event, 'loot', i, 'price')">
          </mat-form-field>
          <button mat-raised-button (click)="removeNewSecondaryItem('loot', i)" color="warn">REMOVE
            LOOT</button>
        </div>
      </div>

      <button mat-raised-button (click)="addNewSecondaryItem('loot')" color="accent">ADD LOOT</button>

      <h3 class="loot-notes-subtitle">Loot Notes</h3>
      <div>
        <quill-editor [(ngModel)]="beast.lootnotes" (onContentChanged)="captureHTML($event, 'lootnotes')">
        </quill-editor>
      </div>
<br/>
      <h3>Lair Loot</h3>
      <div class="lair-loot-shell">
        <mat-form-field>
          <mat-label>Copper</mat-label>
          <mat-select [value]="beast.lairloot.copper" (selectionChange)="captureSelectForObject($event, 'copper', 'lairloot')">
            <mat-option>
              Nothing
            </mat-option>
            <mat-option value="a">
              {{lootTables.staticValues.a}}
            </mat-option>
            <mat-option value="b">
              {{lootTables.staticValues.b}}
            </mat-option>
            <mat-option value="c">
              {{lootTables.staticValues.c}}
            </mat-option>
            <mat-option value="d">
              {{lootTables.staticValues.d}}
            </mat-option>
            <mat-option value="e">
              {{lootTables.staticValues.e}}
            </mat-option>
            <mat-option value="f">
              {{lootTables.staticValues.f}}
            </mat-option>
          </mat-select>
        </mat-form-field>
  
        <mat-form-field>
          <mat-label>Silver</mat-label>
          <mat-select [value]="beast.lairloot.silver" (selectionChange)="captureSelectForObject($event, 'silver', 'lairloot')">
            <mat-option>
              Nothing
            </mat-option>
            <mat-option value="a">
              {{lootTables.staticValues.a}}
            </mat-option>
            <mat-option value="b">
              {{lootTables.staticValues.b}}
            </mat-option>
            <mat-option value="c">
              {{lootTables.staticValues.c}}
            </mat-option>
            <mat-option value="d">
              {{lootTables.staticValues.d}}
            </mat-option>
            <mat-option value="e">
              {{lootTables.staticValues.e}}
            </mat-option>
            <mat-option value="f">
              {{lootTables.staticValues.f}}
            </mat-option>
          </mat-select>
        </mat-form-field>
  
        <mat-form-field>
          <mat-label>Gold</mat-label>
          <mat-select [value]="beast.lairloot.gold" (selectionChange)="captureSelectForObject($event, 'gold', 'lairloot')">
            <mat-option>
              Nothing
            </mat-option>
            <mat-option value="a">
              {{lootTables.staticValues.a}}
            </mat-option>
            <mat-option value="b">
              {{lootTables.staticValues.b}}
            </mat-option>
            <mat-option value="c">
              {{lootTables.staticValues.c}}
            </mat-option>
            <mat-option value="d">
              {{lootTables.staticValues.d}}
            </mat-option>
            <mat-option value="e">
              {{lootTables.staticValues.e}}
            </mat-option>
            <mat-option value="f">
              {{lootTables.staticValues.f}}
            </mat-option>
          </mat-select>
        </mat-form-field>
        
        <mat-form-field>
          <mat-label>Potions</mat-label>
          <mat-select [value]="beast.lairloot.potion" (selectionChange)="captureSelectForObject($event, 'potion', 'lairloot')">
            <mat-option>
              None
            </mat-option>
            <mat-option value="a">
              {{lootTables.numberAppearing.a}}
            </mat-option>
            <mat-option value="b">
              {{lootTables.numberAppearing.b}}
            </mat-option>
            <mat-option value="c">
              {{lootTables.numberAppearing.c}}
            </mat-option>
            <mat-option value="d">
              {{lootTables.numberAppearing.d}}
            </mat-option>
            <mat-option value="e">
              {{lootTables.numberAppearing.e}}
            </mat-option>
            <mat-option value="f">
              {{lootTables.numberAppearing.f}}
            </mat-option>
          </mat-select>
        </mat-form-field>
        
        <mat-form-field>
          <mat-label>Relic Chance</mat-label>
          <mat-select [value]="beast.lairloot.relic" (selectionChange)="captureSelectForObject($event, 'relic', 'lairloot')">
            <mat-option>
              No Chance of Either
            </mat-option>
            <mat-option value="a">
              {{formatRelicAndEnchantedChange(lootTables.relicTable.a)}}
            </mat-option>
            <mat-option value="b">
              {{formatRelicAndEnchantedChange(lootTables.relicTable.b)}}
            </mat-option>
            <mat-option value="c">
              {{formatRelicAndEnchantedChange(lootTables.relicTable.c)}}
            </mat-option>
            <mat-option value="d">
              {{formatRelicAndEnchantedChange(lootTables.relicTable.d)}}
            </mat-option>
            <mat-option value="e">
              {{formatRelicAndEnchantedChange(lootTables.relicTable.e)}}
            </mat-option>
            <mat-option value="f">
              {{formatRelicAndEnchantedChange(lootTables.relicTable.f)}}
            </mat-option>
            <mat-option value="g">
              {{formatRelicAndEnchantedChange(lootTables.relicTable.g)}}
            </mat-option>
          </mat-select>
        </mat-form-field>
        
        <mat-form-field>
          <mat-label>Enchanted Item Chance</mat-label>
          <mat-select [value]="beast.lairloot.enchanted" (selectionChange)="captureSelectForObject($event, 'enchanted', 'lairloot')">
            <mat-option>
              No Chance of Either
            </mat-option>
            <mat-option value="a">
              {{formatRelicAndEnchantedChange(lootTables.enchantedTable.a)}}
            </mat-option>
            <mat-option value="b">
              {{formatRelicAndEnchantedChange(lootTables.enchantedTable.b)}}
            </mat-option>
            <mat-option value="c">
              {{formatRelicAndEnchantedChange(lootTables.enchantedTable.c)}}
            </mat-option>
            <mat-option value="d">
              {{formatRelicAndEnchantedChange(lootTables.enchantedTable.d)}}
            </mat-option>
            <mat-option value="e">
              {{formatRelicAndEnchantedChange(lootTables.enchantedTable.e)}}
            </mat-option>
            <mat-option value="f">
              {{formatRelicAndEnchantedChange(lootTables.enchantedTable.f)}}
            </mat-option>
            <mat-option value="g">
              {{formatRelicAndEnchantedChange(lootTables.enchantedTable.g)}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <h2>Weird Reagents</h2>
      <div class="divider"></div>
      <div *ngFor="let regeant of beast.reagents; let i = index">
        <div *ngIf="!regeant.deleted">
          <mat-form-field>
            <input placeholder="Body Part" matInput [value]="regeant.name"
              (change)="captureInput($event, 'reagents', i, 'name')">
          </mat-form-field>
          <mat-form-field>
            <input placeholder="Spell" matInput [value]="regeant.spell"
              (change)="captureInput($event, 'reagents', i, 'spell')">
          </mat-form-field>
          <mat-form-field>
            <input placeholder="Identification" matInput [value]="regeant.difficulty"
              (change)="captureInput($event, 'reagents', i, 'difficulty')">
          </mat-form-field>
          <mat-form-field>
            <input placeholder="Harvest" matInput [value]="regeant.harvest"
              (change)="captureInput($event, 'reagents', i, 'harvest')">
          </mat-form-field>
          <button mat-raised-button (click)="removeNewSecondaryItem('reagents', i)" color="warn">REMOVE
            REAGENT</button>
        </div>
      </div>

      <button mat-raised-button (click)="addNewSecondaryItem('reagents')" color="accent">ADD REAGENT</button>


      <h2>Variants</h2>
      <div class="divider"></div>
      <mat-chip-list>
        <div *ngFor="let variant of beast.variants; let i = index">
          <mat-chip *ngIf="!variant.deleted" (click)="removeNewSecondaryItem('variants', i)" color="warn" selected>
            {{variant.variantid}}</mat-chip>
        </div>
      </mat-chip-list>
      <mat-form-field>
        <input matInput placeholder="Monster ID" [value]="newVariantId" (change)="captureID($event)">
      </mat-form-field>
      <button mat-raised-button color="accent" (click)="addById()">Add By ID</button>

      <!-- <h2>Special Harvest</h2> -->

      <h2>Meta Notes</h2>
      <div class="divider"></div>
      <div>
        <quill-editor [(ngModel)]="beast.meta" (onContentChanged)="captureHTML($event, 'meta')"></quill-editor>
      </div>

    </div>
  </div>

  <button (click)="saveChanges()" mat-raised-button color="primary">Save</button>
  <button (click)="deleteThisBeast()" mat-raised-button color="warn" class="deleteButton">Delete</button>
</mat-card>